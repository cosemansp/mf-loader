{"version":3,"sources":["webpack://mfLoader/webpack/universalModuleDefinition","webpack://mfLoader/./src/deferred.ts","webpack://mfLoader/./src/scriptLoader.ts","webpack://mfLoader/./src/index.tsx","webpack://mfLoader/webpack/bootstrap","webpack://mfLoader/webpack/runtime/define property getters","webpack://mfLoader/webpack/runtime/hasOwnProperty shorthand","webpack://mfLoader/webpack/runtime/sharing","webpack://mfLoader/webpack/startup"],"names":["root","factory","exports","module","define","amd","self","this","scriptsCache","loadScript","async","src","dfd","args","timeout","resolve","reject","timeoutId","promise","Promise","resolver","rejector","arg","clearTimeout","id","setTimeout","reason","deferred","document","doc","window","script","createElement","setAttribute","addEventListener","err","Error","head","appendChild","loadFromRemote","name","url","moduleName","container","__webpack_init_sharing__","init","__webpack_share_scopes__","default","loadAndInitiateWebpackContainer","get","mounts","register","remote","options","selector","element","querySelector","remoteParts","split","push","start","promisesScripts","map","mount","all","promisesModules","then","forEach","context","console","error","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","m","c","d","definition","key","o","Object","defineProperty","enumerable","obj","prop","prototype","hasOwnProperty","call","S","initPromises","initTokens","I","initScope","initToken","indexOf","promises","length","__webpack_exports__"],"mappings":"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","file":"mfLoader.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"mfLoader\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"mfLoader\"] = factory();\n\telse\n\t\troot[\"mfLoader\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn ","interface DeferredPromise<T> extends Promise<T> {\n  resolve(arg: any);\n  reject(err: any);\n}\n\nexport const deferred = (args: { timeout?: number; id?: any }): DeferredPromise<any> => {\n  args = args || {};\n\n  const { timeout } = args;\n\n  let resolve;\n  let reject;\n  let timeoutId;\n\n  const promise: any = new Promise((resolver, rejector) => {\n    resolve = resolver;\n    reject = rejector;\n  });\n\n  promise.resolve = (arg) => {\n    clearTimeout(timeoutId);\n    resolve(arg);\n  };\n\n  promise.reject = (arg) => {\n    clearTimeout(timeoutId);\n    reject(arg);\n  };\n\n  if (typeof timeout === 'number') {\n    const id = args.id || 'anonymous';\n    timeoutId = setTimeout(() => reject({ reason: `timeout (${timeout}) reached on \"${id}\"` }), timeout);\n  }\n\n  return promise;\n};\n","import { deferred } from './deferred';\n\nconst scriptsCache = {};\n\nexport const loadScript = async (src: string): Promise<any> => {\n  if (scriptsCache[src]) {\n    return scriptsCache[src];\n  }\n\n  const dfd = deferred({ timeout: 30000, id: src });\n\n  const { document: doc } = window;\n\n  const script = doc.createElement('script');\n  script.setAttribute('type', 'text/javascript');\n  script.setAttribute('src', src);\n\n  script.addEventListener('error', (err) => {\n    scriptsCache[src] = null;\n    dfd.reject(new Error(`Failed to load script: ${src}`));\n  });\n\n  script.addEventListener('load', () => {\n    dfd.resolve(script);\n  });\n\n  doc.head.appendChild(script);\n\n  scriptsCache[src] = dfd;\n  return dfd;\n};\n","import { loadScript } from './scriptLoader';\n\ninterface Module {\n  mount: (module: any, options: any) => void;\n}\ninterface Container {\n  init: (module: any) => void;\n  get: (modelName: string) => () => Module;\n}\ndeclare function __webpack_init_sharing__(scope: string): void;\ndeclare let __webpack_share_scopes__: any;\n\nconst loadAndInitiateWebpackContainer = async (name: string, url: string) => {\n  // Initializes the share scope.\n  // This fills it with known provided modules from this build and all remotes\n  await __webpack_init_sharing__('default');\n  const container = (window[name] as any) as Container;\n  if (!container || !container.init) throw new Error(`Cannot load external remote: ${name} from ${url}`);\n\n  // Initialize the container, it may provide shared modules\n  await container.init(__webpack_share_scopes__.default);\n  return container;\n};\n\nconst loadFromRemote = async (name: string, url: string, moduleName: string): Promise<Module> => {\n  const container = await loadAndInitiateWebpackContainer(name, url);\n  if (!container.get) throw new Error(`Cannot load external remote: ${name}`);\n\n  const factory = await container.get(moduleName);\n  const module = factory();\n  return module;\n};\n\nconst mounts = [];\n\nconst register = (remote: string, moduleName: string, options): void => {\n  const { selector } = options || {};\n  const element = document.querySelector(selector);\n  const remoteParts = remote.split('@');\n  const name = remoteParts[0];\n  const url = remoteParts[1];\n  if (!name || !url) {\n    throw Error('Invalid remote');\n  }\n\n  mounts.push({\n    name,\n    url,\n    moduleName,\n    element,\n    selector,\n    options,\n  });\n};\n\nconst start = async () => {\n  // load all scripts\n  const promisesScripts = mounts.map((mount) => {\n    return loadScript(mount.url);\n  });\n  await Promise.all(promisesScripts);\n\n  // get all modules\n  const promisesModules = mounts.map((mount) => {\n    return loadFromRemote(mount.name, mount.url, mount.moduleName).then((module) => {\n      return {\n        module,\n        selector: mount.selector,\n        element: mount.element,\n        options: mount.options,\n      };\n    });\n  });\n  const moduleContexts = await Promise.all(promisesModules);\n\n  // mount modules\n  moduleContexts.forEach((context) => {\n    if (!context.element) {\n      console.error(`Missing or invalid selector: ${context.selector}`);\n    } else {\n      context.module.mount(context.element, context.options);\n    }\n  });\n};\n\nexport default {\n  register,\n  start,\n  loadFromRemote,\n  loadScript,\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n// expose the module cache\n__webpack_require__.c = __webpack_module_cache__;\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","__webpack_require__.S = {};\nvar initPromises = {};\nvar initTokens = {};\n__webpack_require__.I = (name, initScope) => {\n\tif(!initScope) initScope = [];\n\t// handling circular init calls\n\tvar initToken = initTokens[name];\n\tif(!initToken) initToken = initTokens[name] = {};\n\tif(initScope.indexOf(initToken) >= 0) return;\n\tinitScope.push(initToken);\n\t// only runs once\n\tif(initPromises[name]) return initPromises[name];\n\t// creates a new share scope if needed\n\tif(!__webpack_require__.o(__webpack_require__.S, name)) __webpack_require__.S[name] = {};\n\t// runs all init snippets from all modules reachable\n\tvar scope = __webpack_require__.S[name];\n\tvar warn = (msg) => (typeof console !== \"undefined\" && console.warn && console.warn(msg));\n\tvar uniqueName = \"mfLoader\";\n\tvar register = (name, version, factory, eager) => {\n\t\tvar versions = scope[name] = scope[name] || {};\n\t\tvar activeVersion = versions[version];\n\t\tif(!activeVersion || (!activeVersion.loaded && (!eager != !activeVersion.eager ? eager : uniqueName > activeVersion.from))) versions[version] = { get: factory, from: uniqueName, eager: !!eager };\n\t};\n\tvar initExternal = (id) => {\n\t\tvar handleError = (err) => (warn(\"Initialization of sharing external failed: \" + err));\n\t\ttry {\n\t\t\tvar module = __webpack_require__(id);\n\t\t\tif(!module) return;\n\t\t\tvar initFn = (module) => (module && module.init && module.init(__webpack_require__.S[name], initScope))\n\t\t\tif(module.then) return promises.push(module.then(initFn, handleError));\n\t\t\tvar initResult = initFn(module);\n\t\t\tif(initResult && initResult.then) return promises.push(initResult.catch(handleError));\n\t\t} catch(err) { handleError(err); }\n\t}\n\tvar promises = [];\n\tswitch(name) {\n\t}\n\tif(!promises.length) return initPromises[name] = 1;\n\treturn initPromises[name] = Promise.all(promises).then(() => (initPromises[name] = 1));\n};","// module cache are used so entry inlining is disabled\n// startup\n// Load entry module and return exports\nvar __webpack_exports__ = __webpack_require__(773);\n"],"sourceRoot":""}